---
interface Option {
  value: string;
  label: string;
}

interface Props {
  label: string;
  name: string;
  options: Option[];
  placeholder?: string;
  required?: boolean;
  error?: string;
  class?: string;
}

const {
  label,
  name,
  options,
  placeholder = 'Seleccionar...',
  required = false,
  error,
  class: className = '',
} = Astro.props;

const selectId = `select-${name}`;
const hasError = !!error;
---

<div class:list={['flex flex-col gap-1.5', className]}>
  <label for={selectId} class="text-body-sm font-medium text-gray-800">
    {label}
    {required && <span class="text-error ml-0.5">*</span>}
  </label>
  <div class="relative">
    <select
      id={selectId}
      name={name}
      required={required}
      aria-invalid={hasError}
      class:list={[
        'w-full appearance-none px-4 py-2.5 pr-10 rounded-DEFAULT border bg-white text-gray-800',
        'transition-colors duration-200 cursor-pointer',
        'focus:outline-none focus:ring-2 focus:ring-primary-900/20 focus:border-primary-900',
        hasError
          ? 'border-error focus:ring-error/20 focus:border-error'
          : 'border-gray-300 hover:border-gray-400',
      ]}
    >
      <option value="" disabled selected>{placeholder}</option>
      {options.map((opt) => (
        <option value={opt.value}>{opt.label}</option>
      ))}
    </select>
    <span
      class="material-symbols-outlined pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-gray-500"
      style="font-size: 20px;"
      aria-hidden="true"
    >
      expand_more
    </span>
  </div>
  {error && (
    <p class="flex items-center gap-1 text-body-sm text-error">
      <span class="material-symbols-outlined" style="font-size: 16px;" aria-hidden="true">error</span>
      {error}
    </p>
  )}
</div>
